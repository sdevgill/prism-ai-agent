{% extends "base.html" %}

{% block title %}Assets Â· Prism AI Agent{% endblock %}

{% block content %}
    {% url 'sources:ingest' as generate_url %}
    <section class="space-y-8">
        <header class="space-y-2">
            <h1 class="text-3xl font-semibold text-slate-900">Your generated assets</h1>
            <p class="text-sm text-slate-600">All your generated content, organized by type and linked back to whatever you originally fed Prism.</p>
        </header>

        <form method="get" class="space-y-4 rounded-lg border border-slate-200 bg-white p-4 shadow-sm" hx-get="{% url 'assets:library' %}" hx-target="#asset-results" hx-swap="innerHTML">
            <div class="grid gap-4 md:grid-cols-[2fr,1fr]">
                <label class="block text-sm">
                    <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Search</span>
                    <input type="search" name="q" placeholder="Search by source, title, or anything really" class="mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200" />
                </label>
                <label class="block text-sm">
                    <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Source</span>
                    <input type="search" name="source" placeholder="Filter by URL or source title" class="mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200" />
                </label>
            </div>
            <div class="flex justify-end">
                {% include 'partials/components/button.html' with label='Apply filters' type='submit' size='sm' %}
            </div>
        </form>

        <section id="asset-results" class="space-y-10" aria-live="polite">
            {% if assets_by_modality and assets_by_modality.image %}
                {% include 'assets/partials/modality_section.html' with modality='image' assets=assets_by_modality.image generate_url=generate_url %}
            {% elif image_assets %}
                {% include 'assets/partials/modality_section.html' with modality='image' assets=image_assets generate_url=generate_url %}
            {% else %}
                {% include 'assets/partials/modality_section.html' with modality='image' assets=None generate_url=generate_url %}
            {% endif %}

            {% if assets_by_modality and assets_by_modality.audio %}
                {% include 'assets/partials/modality_section.html' with modality='audio' assets=assets_by_modality.audio generate_url=generate_url %}
            {% elif audio_assets %}
                {% include 'assets/partials/modality_section.html' with modality='audio' assets=audio_assets generate_url=generate_url %}
            {% else %}
                {% include 'assets/partials/modality_section.html' with modality='audio' assets=None generate_url=generate_url %}
            {% endif %}

            {% if assets_by_modality and assets_by_modality.video %}
                {% include 'assets/partials/modality_section.html' with modality='video' assets=assets_by_modality.video generate_url=generate_url %}
            {% elif video_assets %}
                {% include 'assets/partials/modality_section.html' with modality='video' assets=video_assets generate_url=generate_url %}
            {% else %}
                {% include 'assets/partials/modality_section.html' with modality='video' assets=None generate_url=generate_url %}
            {% endif %}
        </section>
    </section>
{% endblock %}
